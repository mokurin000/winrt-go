// Code generated by winrt-go-gen. DO NOT EDIT.

//go:build windows

//nolint:all
package media

import (
	"syscall"
	"unsafe"

	"github.com/go-ole/go-ole"
)

const SignatureImageDisplayProperties string = "rc(Windows.Media.ImageDisplayProperties;{cd0bc7ef-54e7-411f-9933-f0e98b0a96d2})"

type ImageDisplayProperties struct {
	ole.IUnknown
}

func (impl *ImageDisplayProperties) GetTitle() (string, error) {
	itf := impl.MustQueryInterface(ole.NewGUID(GUIDiImageDisplayProperties))
	defer itf.Release()
	v := (*iImageDisplayProperties)(unsafe.Pointer(itf))
	return v.GetTitle()
}

func (impl *ImageDisplayProperties) SetTitle(value string) error {
	itf := impl.MustQueryInterface(ole.NewGUID(GUIDiImageDisplayProperties))
	defer itf.Release()
	v := (*iImageDisplayProperties)(unsafe.Pointer(itf))
	return v.SetTitle(value)
}

func (impl *ImageDisplayProperties) GetSubtitle() (string, error) {
	itf := impl.MustQueryInterface(ole.NewGUID(GUIDiImageDisplayProperties))
	defer itf.Release()
	v := (*iImageDisplayProperties)(unsafe.Pointer(itf))
	return v.GetSubtitle()
}

func (impl *ImageDisplayProperties) SetSubtitle(value string) error {
	itf := impl.MustQueryInterface(ole.NewGUID(GUIDiImageDisplayProperties))
	defer itf.Release()
	v := (*iImageDisplayProperties)(unsafe.Pointer(itf))
	return v.SetSubtitle(value)
}

const GUIDiImageDisplayProperties string = "cd0bc7ef-54e7-411f-9933-f0e98b0a96d2"
const SignatureiImageDisplayProperties string = "{cd0bc7ef-54e7-411f-9933-f0e98b0a96d2}"

type iImageDisplayProperties struct {
	ole.IInspectable
}

type iImageDisplayPropertiesVtbl struct {
	ole.IInspectableVtbl

	GetTitle    uintptr
	SetTitle    uintptr
	GetSubtitle uintptr
	SetSubtitle uintptr
}

func (v *iImageDisplayProperties) VTable() *iImageDisplayPropertiesVtbl {
	return (*iImageDisplayPropertiesVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *iImageDisplayProperties) GetTitle() (string, error) {
	var outHStr ole.HString
	hr, _, _ := syscall.SyscallN(
		v.VTable().GetTitle,
		uintptr(unsafe.Pointer(v)),        // this
		uintptr(unsafe.Pointer(&outHStr)), // out string
	)

	if hr != 0 {
		return "", ole.NewError(hr)
	}

	out := outHStr.String()
	ole.DeleteHString(outHStr)
	return out, nil
}

func (v *iImageDisplayProperties) SetTitle(value string) error {
	valueHStr, err := ole.NewHString(value)
	if err != nil {
		return err
	}
	hr, _, _ := syscall.SyscallN(
		v.VTable().SetTitle,
		uintptr(unsafe.Pointer(v)), // this
		uintptr(valueHStr),         // in string
	)

	if hr != 0 {
		return ole.NewError(hr)
	}

	return nil
}

func (v *iImageDisplayProperties) GetSubtitle() (string, error) {
	var outHStr ole.HString
	hr, _, _ := syscall.SyscallN(
		v.VTable().GetSubtitle,
		uintptr(unsafe.Pointer(v)),        // this
		uintptr(unsafe.Pointer(&outHStr)), // out string
	)

	if hr != 0 {
		return "", ole.NewError(hr)
	}

	out := outHStr.String()
	ole.DeleteHString(outHStr)
	return out, nil
}

func (v *iImageDisplayProperties) SetSubtitle(value string) error {
	valueHStr, err := ole.NewHString(value)
	if err != nil {
		return err
	}
	hr, _, _ := syscall.SyscallN(
		v.VTable().SetSubtitle,
		uintptr(unsafe.Pointer(v)), // this
		uintptr(valueHStr),         // in string
	)

	if hr != 0 {
		return ole.NewError(hr)
	}

	return nil
}
